import { Canvas, Meta, Story } from "@storybook/addon-docs";
import { version } from "../../package.json";
import { ComponentTitle, VersionNotice } from "../../../docs/src/partials";
import Box from "@mui/material/Box";
import Typography from "@iccc/typography";

import { themeLight, themeDark } from "@iccc/theme-mui";
import { createTheme, ThemeProvider } from "@mui/material/styles";

<Meta
  component={ThemeProvider}
  id="components/mui-theme"
  parameters={{
    vr: false,
    docs: {
      source: {
        type: "code",
        excludeDecorators: false
      }
    }
  }}
  title="Digital HIG/Components/Theme MUI"
/>

<ComponentTitle name="Theme MUI" status="Stable" />

<code>
  <VersionNotice packageName="theme-mui" version={version} />
</code>

Theme MUI is a Digital HIG theme library which packages [theme data](/docs/iccc-theme-data-overview--page) into MUI compatible JSON. Refer to [MUI Theming](https://mui.com/material-ui/customization/theming/) for detailed summary and follow the installation instructions below for applying Digital HIG styling to your application.

## Installation

Please follow [MUI's default installation instructions](https://mui.com/material-ui/getting-started/installation/#default-installation) and then continue below.

```bash
yarn add @iccc/theme-mui
```

## Importing the themes

```js
import { themeLight, themeDark } from "@iccc/theme-mui";
import { createTheme, ThemeProvider } from "@mui/material/styles";
```

## Usage

This component takes a theme prop and applies it to the entire React tree that it is wrapping around. It should preferably be used at the root of your component tree.

## Available themes

### Light theme

Using `themeLight` JSON.

<Canvas>
  <Story name="Light theme">
    <ThemeProvider theme={createTheme(themeLight)}>
      <Typography>This text should be black</Typography>
    </ThemeProvider>
  </Story>
</Canvas>

### Dark theme

Using `themeDark` JSON.

<Canvas>
  <Story name="Dark theme" parameters={{ theme: "dark" }}>
    <ThemeProvider theme={createTheme(themeDark)}>
      <Typography>This text should be white</Typography>
    </ThemeProvider>
  </Story>
</Canvas>

## Rendering theme in hosts with Digital HIG CSS

If a theme needs to be rendered inside a host page that links to [global CSS](/docs/iccc-css-and-sass-utility-css-overview--page), it is necessary to use a theme prefix to avoid collisions with the static CSS higher-specificity selectors.

```jsx
import { configureClassnameGenerator } from "@iccc/theme-mui";

configureClassnameGenerator({ prefix: "custom" });

<ThemeProvider>...</ThemeProvider>;
```

To use the theme-extending functionality for overriding global HTML font size, please follow the implementation guide in the [Digital HIG Reference App](https://pages.git.autodesk.com/dpe/iccc/#/ref-app/global-font-size).

## Extending theme

Any number of optional Material UI theme arguments can be merged with the theme JSON. Please make use of the API options from [MUI `createTheme()`](https://mui.com/material-ui/customization/theming/#api)

```js
components: {
  MuiLink: {
    styleOverrides: {
      root: {
        color: "mediumseagreen";
      }
    }
  }
}
```

See the [MUI default theme](https://mui.com/material-ui/customization/default-theme/) for more details.

We recommend avoiding overrides whenever possible. There's a cost to injecting multiple theme CSS into the document, so it's good practice to ensure this technique is used sparsely.

### Light theme component overrides

<Canvas>
  <Story name="Extend light theme: component overrides">
    <ThemeProvider
      theme={createTheme(themeLight, {
        components: {
          MuiTypography: {
            styleOverrides: {
              root: {
                color: "mediumseagreen"
              }
            }
          }
        }
      })}
    >
      <Typography>This text should be green.</Typography>
    </ThemeProvider>
  </Story>
</Canvas>

### Dark theme component overrides

Same as above, but specifying `themeDark` as the base theme.

<Canvas>
  <Story
    name="Extend dark theme: component overrides"
    parameters={{ theme: "dark" }}
  >
    <ThemeProvider
      theme={createTheme(themeDark, {
        components: {
          MuiTypography: {
            styleOverrides: {
              root: {
                color: "mediumseagreen"
              }
            }
          }
        }
      })}
    >
      <Typography>This text should be green.</Typography>
    </ThemeProvider>
  </Story>
</Canvas>

### Global component overrides

In this example, all Typography instances are rendered as spans.

<Canvas>
  <Story name="Extend theme: global component overrides">
    <ThemeProvider
      theme={createTheme(themeLight, {
        components: {
          MuiTypography: {
            defaultProps: {
              component: "span"
            }
          }
        }
      })}
    >
      <Typography>This is a span.</Typography>
      <Typography component="p">This is paragraph.</Typography>
    </ThemeProvider>
  </Story>
</Canvas>

### Override other theme properties

Notice how the second example overrides the global theme `spacing` .

<Canvas>
  <Story name="Extend other theme properties">
    <ThemeProvider theme={createTheme(themeLight)}>
      <Box my={1}>
        <Typography>Default spacing: 1 (4px)</Typography>
      </Box>
      <Box my={2}>
        <Typography>Default spacing: 2 (8px)</Typography>
      </Box>
      <Box my={3}>
        <Typography>Default spacing: 3 (12px)</Typography>
      </Box>
      <Box my={4}>
        <Typography>Default spacing: 4 (16px)</Typography>
      </Box>
    </ThemeProvider>
    <ThemeProvider
      theme={createTheme(themeLight, {
        spacing: [0, 1, 2, 3, 4, 5, 6, 7, 8]
      })}
    >
      <Box my={1}>
        <Typography>Overridden spacing: 1 (1px)</Typography>
      </Box>
      <Box my={2}>
        <Typography>Overridden spacing: 2 (2px)</Typography>
      </Box>
      <Box my={3}>
        <Typography>Overridden spacing: 3 (3px)</Typography>
      </Box>
      <Box my={4}>
        <Typography>Overridden spacing: 4 (4px)</Typography>
      </Box>
    </ThemeProvider>
  </Story>
</Canvas>

### Extend multiple themes

Overrides are being applied to light and dark theme instances.

<Canvas>
  <Story name="Extend both themes">
    <>
      <ThemeProvider
        theme={createTheme(themeLight, {
          components: {
            MuiTypography: {
              styleOverrides: {
                root: {
                  color: "mediumseagreen"
                }
              }
            }
          }
        })}
      >
        <Typography>Green text (light theme)</Typography>
      </ThemeProvider>
      <ThemeProvider
        theme={createTheme(themeDark, {
          components: {
            MuiTypography: {
              styleOverrides: {
                root: {
                  color: "mediumseagreen"
                }
              }
            }
          }
        })}
      >
        <Typography>Green text (dark theme)</Typography>
      </ThemeProvider>
      <ThemeProvider
        theme={createTheme(themeLight, {
          components: {
            MuiTypography: {
              styleOverrides: {
                root: {
                  color: "salmon"
                }
              }
            }
          }
        })}
      >
        <Typography>Salmon text (light theme, different prefix)</Typography>
      </ThemeProvider>
    </>
  </Story>
</Canvas>

### Resetting global font size

Digital HIG assumes a default global font size of 16px, but applications built with Digital HIG can't always control the global font size of the webpage where they run.
For this reason, in some cases it may be necessary to reset the font size of the application, so that typography tokens are adjusted on the fly.
For more information, please refer to the [ref-app global font size page](https://pages.git.autodesk.com/dpe/iccc/#/ref-app/global-font-size)
