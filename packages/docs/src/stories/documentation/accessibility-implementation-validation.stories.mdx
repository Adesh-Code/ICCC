import { Meta } from "@storybook/addon-docs";

<Meta
  title="Digital HIG/Documentation/Contributing/Accessibility implementation and validation"
  parameters={{
    viewMode: "docs",
    previewTabs: {
      canvas: { hidden: true }
    }
  }}
/>

# Accessibility implementation and validation

Autodesk is committed to digital equity. We are working to remove barriers between people and their goals and to follow the [Web Content Accessibility Guidelines](https://www.w3.org/TR/WCAG20/) at level [AA](https://www.w3.org/WAI/WCAG21/Understanding/conformance#levels) or above.

The A11y Project provides a [helpful accessibility checklist](https://a11yproject.com/checklist/) for accessibility standards. Learn more about React-specific accessibility standards by reading the [ReactJS.org documentation on accessibility](https://reactjs.org/docs/accessibility.html).

## Table of contents

- [Motivation](#motivation)
- [General guidelines](#general-guidelines)
- [Accessibility automation](#accessibility-automation)
- [Testing accessibility capabilities in unit tests](#testing-accessibility-capabilities-in-unit-tests)
- [Useful links](#useful-links)

### Motivation

> Web accessibility (also referred to as [a11y](https://en.wiktionary.org/wiki/a11y)) is the design and creation of websites that can be used by everyone. Accessibility support is necessary to allow assistive technology to interpret web pages.

‚Äî["Why accessibility?", ReactJS.org](https://reactjs.org/docs/accessibility.html)

[26% of adults in the US](https://www.cdc.gov/ncbddd/disabilityandhealth/infographic-disability-impacts-all.html) have at least one disability. When you improve accessibility, it has an outsized impact on your current and future customers. It‚Äôs also a legal requirement.

### General guidelines

The following are general guidelines to meet when making a component accessible:

#### ‚å® Keyboard navigation

- Allow functionality to be navigated via keyboard controls, and include a visual keyboard focus for active elements.
- Enable control (pause, stop, volume control, etc.) over interactive media such as slideshows or video via mouse and keyboard.

#### üó£ Screen reader support

- Include ability to pass in text alternatives such as alt text, title tags, and ARIA attributes to allow describing non-text content. For example, alt text for images or titles for SVG links.
- Include ability to pass in elements related to input assistance, such as error messaging and labeling for form elements.
- Write code using semantic HTML. As applied to React, this can mean using React Fragments instead of a wrapper `<div>` in cases where the wrapper would make the HTML not semantic (for example, with list items or table rows).

#### üé® Adequate color contrast

- Have sufficient color contrast for colorblind and low vision users (note: Digital HIG color data meets color contrast guidelines).

#### üîç Zoom

- Set font size on the root `<html>` element to 100%. Font size on child elements (such as `<p>`, `<h1>`, etc.) should use `rem` units, which are relative to the root `<html>` element. This will allow font sizes to scale based on the user‚Äôs browser settings for font size (which defaults to 16px).

#### üëÜ Touch-friendly

- Ensure that clickable elements such as buttons or checkboxes have a [sufficient touch target size](https://www.w3.org/WAI/WCAG21/Understanding/target-size.html).

When building Digital HIG components, the provided design specifications should already cover some of these points (e.g. [color contrast](https://iccc.autodesk.com/color-accessibility/)). The base MUI component will likely include several more out of the box, such as keyboard navigation and screen reader support. We rely on automation to capture everything else.

### Accessibility automation

> Automated tools audit the rendered DOM against a set of heuristics based on [WCAG](https://www.w3.org/WAI/standards-guidelines/wcag/) rules and other industry-accepted best practices. They act as the first line of QA to catch blatant accessibility violations.
>
> For example, Axe, on average, finds [57% of WCAG issues automatically](https://www.deque.com/blog/automated-testing-study-identifies-57-percent-of-digital-accessibility-issues/). That allows teams to focus their expert resources on the more complex issues that require manual review.

‚Äî["Automation speeds up your workflow", Storybook blog](https://storybook.js.org/blog/accessibility-testing-with-storybook/)

The Storybook addon runs [Axe](https://www.deque.com/axe/) on the currently selected story and visualizes the test results in the accessibility panel. Running these checks throughout the development process shortens the feedback loop and enables issues to be fixed earlier in the process. Currently, each component will be tested automatically upon viewing the story of any given component:

![Digital HIG button with Storybook accessibility addon](./images/accessibility/001.png)

If there are any violations, these should be resolved in order of severity:

![Storybook accessibility addon with violations](./images/accessibility/002.png)

Components that have no accessibility impact will pass this test by default.

## Testing accessibility capabilities in unit tests

Unit tests are included per component and are run every time a developer commits new code, as well as during the PR build process on the server. Introducing accessibility testing into unit tests can thus be beneficial in many cases.

Below is a simplified example test using [Jest](https://jestjs.io/) and [React Testing Library](https://testing-library.com/docs/dom-testing-library/api-accessibility). These types of unit tests should be written for all Digital HIG wrapper components (i.e. any component not pulled directly from Material UI).

```javascript
import React from "react";
import Modal from "@iccc/modal";
import { render, screen } from "@testing-library/react";

import { themeLight } from '@iccc/theme-mui';
import { createTheme, ThemeProvider } from '@mui/material/styles';

const light = createTheme(themeLight);

describe("Modal component", () => {
  it("renders with accessibility props", () => {
    render(
      <ThemeProvider theme={light}>
        <Modal
          aria-describedby="aria-described-by-test"
          aria-labelledby="aria-labelled-by-test"
        />
      </ThemeProvider>
    );

    const modal = screen.getByRole("dialog");

    expect(modal).toHaveAttribute("aria-labelledby", "aria-labelled-by-test");
    expect(modal).toHaveAttribute("aria-describedby", "aria-described-by-test");
  });
});
```

## Useful links

- [WCAG 2 Overview](https://www.w3.org/WAI/standards-guidelines/wcag/)
- [W3.org: tips](https://www.w3.org/WAI/tips/developing/)
- [Reactjs.org documentation on accessibility](https://reactjs.org/docs/accessibility.html)
- [A11y Project accessibility checklist](https://a11yproject.com/checklist/)
- [MDN: Accessibility](https://developer.mozilla.org/en-US/docs/Web/Accessibility)
